<% layout("/layouts/boilerplate") %>
    <style>
      #filters{
        display: flex;
        align-items: center;
        overflow-x: auto;
        white-space: nowrap;
        gap: 1rem;
        padding: 1rem;
      }
      .filter{
        text-align: center;
        margin: 0.1rem;
        flex: 0 0 auto;
        opacity: 0.7;
      }
      .filter:hover{
        opacity: 1;
        cursor: pointer;
      }
      #filters::-webkit-scrollbar {
         height: 8px;
      }
      #filters::-webkit-scrollbar-thumb {
         background-color: #555;
         border-radius: 5px;
      }
      @media (min-width: 1200px) {
     #filters {
      flex-wrap: wrap;
      overflow-x: visible;
      }
      }

/* Medium screens: horizontal scrollable filter */
@media (max-width: 1199px) and (min-width: 768px) {
  #filters {
    display: flex;
    flex-direction: row;
    gap: 1rem;
    overflow-x: auto;
    white-space: nowrap;
  }
  } 


/* Small screens: vertical collapsible or scrollable filter */
@media (max-width: 767px) {
  #filters {
    display: flex;
    flex-direction: row;
    gap: 1rem;
    overflow-x: auto;
    white-space: nowrap;
  }
 
}
      .filter p{
        font-size: 0.8rem;
      }

      .tax-info{
        display: none;
      }

      .tax-toggle{
        border: 1px solid black;
        border-radius: 1rem;
        height: 3.2rem;
        padding: 1rem;
        margin-left: 2rem;
        display: flex;
        align-items: center;
      }
      a{
        text-align: center;
        border-radius: 5px;
        text-decoration: none;
        transition:0.3s ease;
        opacity: 1;
        color: black;
      }
      a:hover{    
      opacity: 1.5;
      }
      .clear-btn{
        margin-top: 10px;
        font-size: 14px;
      }

      
    </style>
    <div id="filters" >
      <div class="filter">
       <div> <a href="/listings?category=Trending" class="filter-link" data-category="Thending"><i class="fa-solid fa-fire"></i></a></div>
        <a href="/listings?category=Trending" class="filter-link" data-category="Thending">Trending</a>
      </div>

      <div class="filter">
        <div><a  href="/listings?category=Rooms" class="filter-link" data-category="Rooms"><i class="fa-solid fa-bed"></i></a></div>
        <a href="/listings?category=Rooms" class="filter-link" data-category="Rooms">Rooms</a>
      </div>

      <div class="filter">
        <div><a href="/listings?category=Iconic City" class="filter-link" data-category="Iconic Ciry"><i class="fa-solid fa-mountain-city"></i></a></div>
        <a href="/listings?category=Iconic City" class="filter-link" data-category="Iconic Ciry">Iconic Ciry</a>
      </div>

      <div class="filter">
        <div><a href="/listings?category=Mountains" class="filter-link" data-category="Mountains"><i class="fa-solid fa-mountain"></i></a></div>
        <a href="/listings?category=Mountains" class="filter-link" data-category="Mountains">Mountains</a>
      </div>

      <div class="filter">
        <div><a href="/listings?category=Castles" class="filter-link" data-category="Castles"><i class="fa-brands fa-fort-awesome"></i></a></div>
        <a href="/listings?category=Castles" class="filter-link" data-category="Castles">Castles</a>
      </div>
      
      <div class="filter">
        <div><a href="/listings?category=Amazing Pools" class="filter-link" data-category="Amazing Pools"><i class="fa-solid fa-person-swimming"></i></a></div>
        <a href="/listings?category=Amazing Pools" class="filter-link" data-category="Amazing Pools">Amazing Pools</a>
      </div>

      <div class="filter">
        <div> <a  href="/listings?category=Farms" class="filter-link" data-category="Farms"><i class="fa-solid fa-cow"></i></a></div>
        <a href="/listings?category=Farms" class="filter-link" data-category="Farms">Farms</a>
      </div>

      <div class="filter">
        <div> <a href="/listings?category=Camping" class="filter-link" data-category="Camping"><i class="fa-solid fa-campground"></i></i></a></div>
        <a href="/listings?category=Camping" class="filter-link" data-category="Camping">Camping</a>
      </div>
      
      <div class="filter">
        <div>  <a href="/listings?category=Arctic" class="filter-link" data-category="Arctic"><i class="fa-regular fa-snowflake"></i></a></div>
        <a href="/listings?category=Arctic" class="filter-link" data-category="Arctic">Arctic</a>
      </div>

      <div class="filter">
        <div><a href="/listings?category=Boats" class="filter-link" data-category="Boats"><i class="fa-solid fa-ship"></i></a></div>
        <a href="/listings?category=Boats" class="filter-link" data-category="Boats">Boats</a>
      </div>
      
      <div class="filter">
        <div><a href="/listings?category=Domes" class="filter-link" data-category="Domes"><i class="fa-solid fa-igloo"></i></a></div>
        <a href="/listings?category=Domes" class="filter-link" data-category="Domes">Domes</a>
      </div>

      <div class="filter">
        <div><a href="/listings"  class="clear-btn" class="filter-link" data-category="Clear Filter"><i class="fa-solid fa-broom"></i></a></div>
      <a href="/listings"  class="clear-btn" class="filter-link" data-category="Clear Filter">Clear Filter</a>
    </div>

      <div class="tax-toggle">
        <div class="form-check-reverse form-switch">
          <input class="form-check-input" type="checkbox" role="switch" id="flexSwitchCheckDefault">
          <label class="form-check-label" for="flexSwitchCheckDefault">Display Total after Taxes</label>
        </div>
      </div>
 
     
    </div>

    

    <div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3">
    <% for(listing of allListings){%>
        <a href="/listings/<%= listing._id %>" class="listing-link">
    <div class="card col listing-card">
        <img src="<%= listing.image.url %>" class="card-img-top" alt="listing_image" style="height: 20rem;">
        <div class="card-img-overlay"></div>
        <div class="card-body">
          <p class="card-text">
            <b><%= listing.title %></b><br>
            &#8377;<%= listing.price.toLocaleString("en-IN"); %>/night<br>
            <i class="tax-info"> &nbsp; &nbsp;+18% GST</i>
        </p>
        </div>
      </div>
    </a>
      <%}%>
    </div>


  <script>
    let taxSwitch  = document.getElementById("flexSwitchCheckDefault");
    taxSwitch.addEventListener("click",()=>{
    let taxInfo = document.getElementsByClassName("tax-info");
    for(info of taxInfo){
      if(info.style.display != "inline"){
        info.style.display = "inline";
      }else{
        info.style.display = "none";
      }
    }
    });

      document.addEventListener('DOMContentLoaded', () => {
      history.replaceState({}, '', '/listings');
      fetchListings();  
    });

  </script>
